# Утилита генерации методов Reset()

Эта утилита автоматически генерирует методы `Reset()` для структур, помеченных комментарием `// generate:reset`.

## Назначение

Утилита предназначена для автоматической генерации методов сброса состояния структур к начальным значениям. Это полезно для:
- Сброса кэшированных данных
- Очистки структур в тестах
- Переиспользования объектов без создания новых экземпляров

## Использование

### Запуск утилиты

```bash
go run ./cmd/reset <путь-к-проекту>
```

Например:
```bash
go run ./cmd/reset .
```

### Разметка структур

Чтобы утилита сгенерировала метод `Reset()` для структуры, добавьте комментарий `// generate:reset` перед объявлением структуры:

```go
// generate:reset
type MyStruct struct {
    Name    string
    Count   int
    Items   []string
    Config  map[string]string
    Pointer *int
}
```

### Сгенерированный код

Для приведённой выше структуры будет сгенерирован следующий метод:

```go
func (m *MyStruct) Reset() {
    if m == nil {
        return
    }

    m.Name = ""
    m.Count = 0
    m.Items = m.Items[:0]
    clear(m.Config)
    if m.Pointer != nil {
        *m.Pointer = 0
    }
}
```

## Правила генерации

### Примитивные типы
- `int`, `int8`, `int16`, `int32`, `int64` → `0`
- `uint`, `uint8`, `uint16`, `uint32`, `uint64` → `0`
- `float32`, `float64` → `0.0`
- `string` → `""`
- `bool` → `false`

### Сложные типы
- **Слайсы**: `slice = slice[:0]` (обрезка, но не зануление)
- **Мапы**: `clear(map)` (очистка)
- **Указатели**: Проверка на nil, затем разыменование и сброс значения

### Вложенные структуры
- Если поле является указателем на структуру с методом `Reset()`, вызывается этот метод
- Если поле реализует интерфейс `interface{ Reset() }`, вызывается метод через интерфейс

## Примеры

### Простая структура
```go
// generate:reset
type SimpleStruct struct {
    IntField    int
    StringField string
    BoolField   bool
}
```

### Сложная структура
```go
// generate:reset
type ComplexStruct struct {
    IntSlice    []int
    StringSlice []string
    IntMap      map[string]int
    IntPtr      *int
    Nested      *SimpleStruct
}
```

## Интеграция с go:generate

Для автоматической генерации методов при сборке проекта добавьте в файлы сгенерированных методов:

```go
//go:generate go run ../../cmd/reset
```

## Ограничения

1. Утилита обрабатывает только структуры с комментарием `// generate:reset`
2. Генерируются только методы для полей, поддерживаемых утилитой
3. Циклические зависимости между структурами не поддерживаются
4. Анонимные поля (встроенные структуры) обрабатываются ограниченно

## Файлы

Утилита создаёт файлы `reset.gen.go` в тех же пакетах, где находятся отмеченные структуры. Каждый файл содержит:
- Заголовок с информацией о генерации
- Директиву `//go:generate`
- Методы `Reset()` для всех структур пакета

## Тестирование

Для проверки работы утилиты можно использовать созданные примеры в пакетах:
- `internal/resetexamples/`
- `internal/resetexamples/`
- `internal/resetexamples/`

Запустите утилиту и проверьте сгенерированные файлы `reset.gen.go`.